{"version":3,"sources":["components/TopFree.jsx","components/TopGrossing.jsx","components/AllTopFree.jsx","components/Main.jsx","redux/thunk.js"],"names":["TopFree","react_default","a","createElement","key","this","props","index","className","src","artworkUrl100","alt","trackName","genres","build_default","rating","averageUserRating","starDimension","starSpacing","starRatedColor","starEmptyColor","userRatingCount","concat","React","Component","TopGrossing","connect","state","topFree","app","_ref","items","loadMoreItems","hasNextPage","isItemLoaded","length","Row","_ref2","map","i","TopFree_TopFree","id","loading","itemCount","react_window_infinite_loader_dist_index_esm","_ref3","onItemsRendered","ref","dist_index_esm","height","itemSize","Main","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","loadMore","count","currentCount","offset","setState","moreItemsLoading","total","listItems","item","toConsumableArray","loadDataThunk","updateSearch","e","search","currentTarget","value","substr","_this2","filteredFreeResult","filter","result","toLowerCase","includes","filteredGrossingResult","topGrossing","topFreeResult","topGrossingResult","components_TopGrossing","allTopGrossing","index_esm","onChange","placeholder","AllTopFree","mapDispatchToProps","category","num","asyncToGenerator","regenerator_default","mark","_callee","dispatch","res","wrap","_context","prev","next","axios","process","sent","data","loadData","failed","stop","_x","apply","arguments"],"mappings":"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","file":"static/js/4.b1f927c0.chunk.js","sourcesContent":["import React from \"react\";\nimport \"./css/TopFree.css\";\nimport StarRatings from \"react-star-ratings\";\n\nexport default class TopFree extends React.Component {\n  render() {\n    return (\n      <div key={this.props.index} className=\"vertical\">\n        <h3>{this.props.index + 1}</h3>\n        <div className=\"app-img\">\n          <img\n            className={(this.props.index + 1) % 2 === 0 ? \"even\" : \"odd\"}\n            src={this.props.artworkUrl100}\n            alt={this.props.trackName}\n          />\n        </div>\n        <div className=\"app-info\">\n          <div className=\"app-name\">{this.props.trackName}</div>\n          <div className=\"genres\">{this.props.genres}</div>\n          <div className=\"app-rating\">\n            <StarRatings\n              rating={this.props.averageUserRating}\n              starDimension=\"15px\"\n              starSpacing=\"1px\"\n              starRatedColor=\"rgb(254,149,0)\"\n              starEmptyColor=\"rgb(250,250,255)\"\n            />\n            <div className=\"count\">\n              {this.props.userRatingCount\n                ? `(${this.props.userRatingCount})`\n                : `(0)`}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport \"./css/TopGrossing.css\";\n\nconst TopGrossing = props => {\n  return (\n    <div className=\"top-grossing\">\n      <div index={props.index} className=\"horizontal\">\n        <img\n          className=\"image\"\n          src={props.artworkUrl100}\n          alt={props.trackName}\n        />\n        <div className=\"app-name\">{props.trackName}</div>\n        <div className=\"genre\">{props.genres}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default TopGrossing;\n","import React from \"react\";\nimport { FixedSizeList } from \"react-window\";\nimport InfiniteLoader from \"react-window-infinite-loader\";\nimport TopFree from \"./TopFree\";\nimport { connect } from \"react-redux\";\nimport loading from \"../icons/loading.gif\";\n\n\n const TopFreeList = ({ items, loadMoreItems, hasNextPage }) => {\n  \n\n  const isItemLoaded = index => !hasNextPage || index < items.length\n  const Row = ({index})=>(\n    <div>\n      { !isItemLoaded(index)?\n      <img id=\"loading-app\" src={loading} alt=\"loading...\" />\n      :\n\n      items.map((app, i) => {\n        return (\n          <TopFree\n            key={i}\n            index={i}\n            artworkUrl100={app.artworkUrl100}\n            trackName={app.trackName}\n            genres={app.genres}\n            averageUserRating={app.averageUserRating}\n            userRatingCount={app.userRatingCount}\n          />\n        );\n      })\n      }\n        \n    </div>\n        \n    )\n\n  const itemCount = hasNextPage ? items.length + 1 : items.length;\n  return (\n    <InfiniteLoader\n      isItemLoaded={isItemLoaded}\n      itemCount={itemCount}\n      loadMoreItems={loadMoreItems}\n    >\n      {({ onItemsRendered, ref }) => (\n        <FixedSizeList\n          height={450}\n          itemSize={30}\n          itemCount={itemCount}\n          onItemsRendered={onItemsRendered}\n          ref={ref}\n        >\n            {Row}\n        </FixedSizeList>\n      )}\n    </InfiniteLoader>\n  );\n};\n\nconst mapStateToProps = state => {\n  return { topFree: state.app.topFree };\n};\n\n\nexport default connect(mapStateToProps,null)(TopFreeList)","import React from \"react\";\nimport { FaSistrix } from \"react-icons/fa\";\nimport \"./css/Search.css\";\nimport { connect } from \"react-redux\";\nimport { loadDataThunk } from \"../redux/thunk\";\nimport TopFree from \"./TopFree\";\nimport TopGrossing from \"./TopGrossing\";\nimport TopFreeList from \"./AllTopFree\";\n\nclass Main extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search: \"\",\n      total: 100,\n      currentCount: 10,\n      offset: 10,\n      listItems: [],\n      moreItemsLoading: false,\n      hasNextPage: true\n    };\n  }\n  componentDidMount() {\n    this.props.loadDataThunk(\"top-free\",10);\n    this.props.loadDataThunk(\"top-grossing\");\n  }\n\n\n  loadMore = () => {\n  \n    let count = this.state.currentCount + this.state.offset;\n\n    this.setState({ moreItemsLoading: true }, () => {\n      if(count <= this.state.total){\n        this.setState(state => ({\n          hasNextPage: state.listItems.length < this.state.total,\n          moreItemsLoading: false,\n          currentCount: count,\n          item: [...state.listItems].concat(\n            this.props.topFree\n            \n          )\n        }));\n        this.props.loadDataThunk(\"top-free\", count);\n      }\n    });\n  };\n\n  updateSearch = e => {\n    this.setState({\n      search: e.currentTarget.value.substr(0, 20)\n    });\n  };\n\n  render() {\n    const filteredFreeResult = this.props.topFree.filter(result => {\n      return result.trackName\n        .toLowerCase()\n        .includes(this.state.search.toLowerCase());\n    });\n\n    const filteredGrossingResult = this.props.topGrossing.filter(result => {\n      return result.trackName\n        .toLowerCase()\n        .includes(this.state.search.toLowerCase());\n    });\n\n    const topFreeResult = filteredFreeResult.map((result, i) => {\n      return (\n        <TopFree\n          key={i}\n          artworkUrl100={result.artworkUrl100}\n          trackName={result.trackName}\n          genres={result.genres}\n          averageUserRating={result.averageUserRating}\n          userRatingCount={result.userRatingCount}\n          index={i}\n        />\n      );\n    });\n\n    const topGrossingResult = filteredGrossingResult.map((result, i) => {\n      return (\n        <TopGrossing\n          key={i}\n          artworkUrl100={result.artworkUrl100}\n          trackName={result.trackName}\n          genres={result.genres}\n          index={i}\n        />\n      );\n    });\n\n    const allTopGrossing = this.props.topGrossing.map((app, i) => {\n      return (\n        <TopGrossing\n          key={i}\n          artworkUrl100={app.artworkUrl100}\n          trackName={app.trackName}\n          genres={app.genres}\n          index={i}\n        />\n      );\n    });\n\n    return (\n      <div className=\"main\">\n        <div className=\"search-area\">\n          <FaSistrix />\n          <input\n            className=\"search\"\n            value={this.state.search}\n            onChange={this.updateSearch}\n            placeholder={`搜尋`}\n          />\n        </div>\n        <div className=\"grossing-and-free\">\n          <h2> 推介 </h2>\n          <div className=\"top-grossing-section\">\n            {this.state.search ? topGrossingResult : allTopGrossing}\n          </div>\n          <div className=\"top-free\">\n            {this.state.search ? (\n              topFreeResult\n            ) : (\n              <TopFreeList\n                items={this.props.topFree}\n                moreItemsLoading={this.state.moreItemsLoading}\n                loadMoreItems={this.loadMore}\n                hasNextPage={this.state.hasNextPage}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    topFree: state.app.topFree,\n    topGrossing: state.app.topGrossing\n  };\n};\n\nconst mapDispatchToProps = { loadDataThunk };\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Main);\n","import { loadData, failed } from \"./actions\";\nimport axios from \"axios\";\n\nconst { REACT_APP_API_SERVER } = process.env;\n\nexport const loadDataThunk = (category, num) => {\n  return async dispatch => {\n    const res = await axios(\n      // `https://rss.itunes.apple.com/api/v1/hk/ios-apps/${category}/all/${num ? `${num}` : `10`}/explicit.json`\n      `${REACT_APP_API_SERVER}/${category}/${num ? `${num}` : \"10\"}`\n    );\n    if (res.data) {\n      dispatch(loadData(res.data, category));\n    } else {\n      dispatch(failed(\"failed to fetch\"));\n    }\n  };\n};\n"],"sourceRoot":""}